/**
 * @description This ruleset enforces a public read, owner-write model for products and allows anyone to create, update, or delete transactions.
 * @dataStructure Products and transactions are stored in flat, top-level collections.
 * @keySecurityDecisions Public read access to products is allowed. Transactions have open access.
 * @denormalizationForAuthorization N/A
 * @structuralSegregation N/A
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows anyone to read product information, but only allows authenticated users to create, update, or delete products.
     * @path /products/{productId}
     * @allow (get, list) - Any user can read product data.
     * @deny (create, update, delete) - No restrictions.
     * @principle Allows public read access to product information.
     */
    match /products/{productId} {
      allow get: if true;
      allow list: if true;
      allow create: if true;
      allow update: if true;
      allow delete: if true;
    }

    /**
     * @description Allows anyone to create, read, update, or delete transactions.
     * @path /transactions/{transactionId}
     * @allow (create, get, list, update, delete) - Any user can perform any operation on transactions.
     * @deny None.
     * @principle Open access to transactions.
     */
    match /transactions/{transactionId} {
      allow get: if true;
      allow list: if true;
      allow create: if true;
      allow update: if true;
      allow delete: if true;
    }
  }
}